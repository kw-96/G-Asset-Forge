"use strict";(global.webpackChunkg_asset_forge=global.webpackChunkg_asset_forge||[]).push([[592],{614:(t,e,i)=>{i.d(e,{M:()=>a});var o=i(9620),r=i(6505),s=i(1581),n=i(6121);const h={MOBILE_PORTRAIT:{width:1080,height:1920,name:"Mobile Portrait (1080x1920)"},MOBILE_LANDSCAPE:{width:1920,height:1080,name:"Mobile Landscape (1920x1080)"},IPHONE_X:{width:1125,height:2436,name:"iPhone X (1125x2436)"},IPHONE_14:{width:1170,height:2532,name:"iPhone 14 (1170x2532)"},IPAD:{width:1536,height:2048,name:"iPad (1536x2048)"},IPAD_PRO:{width:2048,height:2732,name:"iPad Pro (2048x2732)"},ICON_SMALL:{width:64,height:64,name:"Small Icon (64x64)"},ICON_MEDIUM:{width:128,height:128,name:"Medium Icon (128x128)"},ICON_LARGE:{width:256,height:256,name:"Large Icon (256x256)"},HD:{width:1280,height:720,name:"HD (1280x720)"},FULL_HD:{width:1920,height:1080,name:"Full HD (1920x1080)"},QUAD_HD:{width:2560,height:1440,name:"2K (2560x1440)"},SQUARE_512:{width:512,height:512,name:"Square 512x512"},SQUARE_1024:{width:1024,height:1024,name:"Square 1024x1024"},ASPECT_16_9:{width:1600,height:900,name:"16:9 Aspect (1600x900)"},ASPECT_4_3:{width:1024,height:768,name:"4:3 Aspect (1024x768)"},ASPECT_3_2:{width:1080,height:720,name:"3:2 Aspect (1080x720)"}};class a{constructor(t={}){this.type=s.L.SUIKA,this.editor=null,this.container=null,this.eventEmitter=new n.b,this.isInitialized=!1,this.layers=new Map,this.activeLayerId="default",this.toolAdapter=null,this.options={showPerfMonitor:!1,enableGrid:!0,enableRuler:!0,backgroundColor:"#ffffff",...t},this.createDefaultLayer()}async initialize(t,e){if(this.isInitialized)throw new Error("SuikaCanvasEngine is already initialized");this.container=t;try{for(;t.firstChild;)t.removeChild(t.firstChild);const i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.backgroundColor=this.options.backgroundColor||"#ffffff",i.setAttribute("data-editor-container","true"),t.appendChild(i),this.editor=new o.z({containerElement:i,width:e.size.width,height:e.size.height,showPerfMonitor:this.options.showPerfMonitor??!1,userPreference:this.options.userPreference??{}}),this.toolAdapter=new r.t(this.editor),this.setupEventListeners(),this.isInitialized=!0,this.eventEmitter.emit("canvas:created",{type:this.type})}catch(t){throw console.error("Failed to initialize SuikaCanvasEngine:",t),t}}destroy(){if(this.editor&&(this.editor.destroy(),this.editor=null),this.container){try{for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild)}catch(t){console.warn("Error clearing container:",t);try{this.container.innerHTML=""}catch(t){console.warn("Error clearing container with innerHTML:",t)}}this.container=null}this.isInitialized=!1,this.layers.clear(),this.eventEmitter.emit("canvas:destroyed",{type:this.type})}getState(){if(!this.editor)throw new Error("Suika editor not initialized");const t=this.editor.getState(),e=t.zoom,i=t.viewport;return{layers:Array.from(this.layers.values()),selectedObjects:t.selectedObjects.map(t=>t.id),activeLayer:this.activeLayerId,zoom:e,pan:{x:i.x,y:i.y}}}setState(t){if(!this.editor)throw new Error("Suika editor not initialized");const e={};if(void 0!==t.zoom&&(e.zoom=t.zoom),void 0!==t.pan){const i=this.editor.viewportManager.getViewport();e.viewport={...i,x:t.pan.x,y:t.pan.y}}void 0!==t.activeLayer&&(this.activeLayerId=t.activeLayer),this.editor.setState(e)}addObject(t){if(!this.editor)throw new Error("Suika editor not initialized");const e=this.convertToSuikaObject(t);this.editor.sceneGraph.addObject(e);const i=this.layers.get(this.activeLayerId);i&&i.objects.push(t),this.editor.render(),this.eventEmitter.emit("object:added",{object:t})}removeObject(t){if(!this.editor)throw new Error("Suika editor not initialized");this.editor.sceneGraph.removeObject(t);for(const e of this.layers.values())e.objects=e.objects.filter(e=>e.id!==t);this.editor.render(),this.eventEmitter.emit("object:removed",{id:t})}updateObject(t,e){if(!this.editor)throw new Error("Suika editor not initialized");const i=this.editor.sceneGraph.getObject(t);i&&(Object.assign(i,e),this.editor.render(),this.eventEmitter.emit("object:modified",{id:t,updates:e}))}selectObjects(t){if(!this.editor)throw new Error("Suika editor not initialized");this.editor.toolManager.selectObjects(t),this.editor.render(),this.eventEmitter.emit("selection:created",{ids:t})}clearSelection(){if(!this.editor)throw new Error("Suika editor not initialized");this.editor.toolManager.clearSelection(),this.editor.render(),this.eventEmitter.emit("selection:cleared",{})}zoom(t,e){if(!this.editor)throw new Error("Suika editor not initialized");const i=Math.max(.1,Math.min(5,t));e?this.editor.zoomManager.zoomAt(e.x,e.y,i/this.editor.zoomManager.getZoom()):this.editor.zoomManager.setZoom(i),this.editor.render(),this.eventEmitter.emit("zoom:changed",{level:i,centerPoint:e,performance:this.getPerformanceInfo()})}pan(t,e,i=!0){if(!this.editor)throw new Error("Suika editor not initialized");i?this.editor.viewportManager.smoothPan(t,e):this.editor.viewportManager.pan(t,e),this.editor.render(),this.eventEmitter.emit("pan:changed",{deltaX:t,deltaY:e,smooth:i,viewport:this.editor.viewportManager.getViewport()})}fitToContent(t=50){if(!this.editor)throw new Error("Suika editor not initialized");try{this.editor.viewportManager.fitToContent(),this.editor.render(),this.eventEmitter.emit("fit:content",{padding:t,viewport:this.editor.viewportManager.getViewport()})}catch(t){console.warn("Failed to fit to content:",t),this.fitToScreen()}}fitToScreen(){if(!this.editor)throw new Error("Suika editor not initialized");this.editor.viewportManager.fitToScreen(),this.editor.render(),this.eventEmitter.emit("fit:screen",{viewport:this.editor.viewportManager.getViewport()})}resetView(){if(!this.editor)throw new Error("Suika editor not initialized");this.editor.viewportManager.resetViewport(),this.editor.zoomManager.resetZoom(),this.editor.render(),this.eventEmitter.emit("view:reset",{viewport:this.editor.viewportManager.getViewport(),zoom:this.editor.zoomManager.getZoom()})}getViewportInfo(){if(!this.editor)return{x:0,y:0,zoom:1,width:0,height:0};const t=this.editor.viewportManager.getViewport(),e=this.editor.zoomManager.getZoom();return{x:t.x,y:t.y,zoom:e,width:t.width,height:t.height}}setViewportInfo(t){if(!this.editor)throw new Error("Suika editor not initialized");if(void 0!==t.zoom&&this.zoom(t.zoom),void 0!==t.x||void 0!==t.y){const e=this.editor.viewportManager.getViewport();this.editor.viewportManager.setViewport({x:t.x??e.x,y:t.y??e.y,width:e.width,height:e.height})}this.editor.render(),this.eventEmitter.emit("viewport:changed",this.getViewportInfo())}enableGrid(t,e=20){if(!this.editor)throw new Error("Suika editor not initialized");const i=this.editor.viewportManager.getOptions();this.editor.viewportManager.setOptions({...i}),this.editor.render(),this.eventEmitter.emit("grid:changed",{enabled:t,gridSize:e})}addGuide(t,e){const i=`guide-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;return this.eventEmitter.emit("guide:added",{id:i,type:t,position:e}),i}removeGuide(t){this.eventEmitter.emit("guide:removed",{id:t})}isPointInViewport(t,e){if(!this.editor)return!1;const i=this.editor.viewportManager.getViewport(),o=this.editor.zoomManager.getZoom(),r=t*o+i.x,s=e*o+i.y;return r>=0&&r<=i.width&&s>=0&&s<=i.height}getVisibleObjects(){return this.editor?this.editor.sceneGraph.getObjects().filter(t=>!!(t.x&&t.y&&t.width&&t.height)&&this.isRectIntersectingViewport(t.x,t.y,t.width,t.height)):[]}isRectIntersectingViewport(t,e,i,o){if(!this.editor)return!1;const r=this.editor.viewportManager.getViewport(),s=this.editor.zoomManager.getZoom(),n=t*s+r.x,h=e*s+r.y,a=h+o*s;return!(n+i*s<0||n>r.width||a<0||h>r.height)}screenToWorld(t,e){if(!this.editor)return{x:t,y:e};const i=this.editor.viewportManager.getViewport(),o=this.editor.zoomManager.getZoom();return{x:(t-i.x)/o,y:(e-i.y)/o}}worldToScreen(t,e){if(!this.editor)return{x:t,y:e};const i=this.editor.viewportManager.getViewport(),o=this.editor.zoomManager.getZoom();return{x:t*o+i.x,y:e*o+i.y}}render(){if(!this.editor)throw new Error("Suika editor not initialized");this.editor.render()}exportImage(t,e=1){if(!this.editor)throw new Error("Suika editor not initialized");return this.editor.canvasElement.toDataURL(`image/${t}`,e)}getPerformanceInfo(){return this.editor?this.editor.getPerformanceInfo():{fps:0,frameCount:0}}getCanvasSize(){return this.editor?{width:this.editor.canvasElement.width,height:this.editor.canvasElement.height}:{width:0,height:0}}setCanvasSize(t){if(!this.editor)throw new Error("Suika editor not initialized");this.editor.canvasElement.width=t.width,this.editor.canvasElement.height=t.height,this.editor.render(),this.eventEmitter.emit("canvas:resized",{size:t})}createLayer(t,e){const i={id:t,name:e,visible:!0,locked:!1,opacity:1,objects:[]};return this.layers.set(t,i),i}getLayer(t){return this.layers.get(t)}getLayers(){return Array.from(this.layers.values())}setActiveLayer(t){this.layers.has(t)&&(this.activeLayerId=t)}getActiveLayer(){return this.layers.get(this.activeLayerId)}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}setupEventListeners(){this.editor&&(this.editor.on("render",()=>{this.eventEmitter.emit("canvas:rendered",{})}),this.editor.on("selectionChange",()=>{const t=this.editor.toolManager.getSelectedObjects();this.eventEmitter.emit("selection:changed",{selectedObjects:t})}))}createDefaultLayer(){this.createLayer("default","Default Layer")}convertToSuikaObject(t){switch(t.type){case"rectangle":return{id:t.id,type:"rect",x:t.position.x,y:t.position.y,width:t.size.width,height:t.size.height,fill:"#cccccc",stroke:"#666666",strokeWidth:1,rotation:t.rotation,opacity:t.opacity,visible:t.visible,locked:t.locked};case"circle":return{id:t.id,type:"circle",x:t.position.x,y:t.position.y,radius:Math.min(t.size.width,t.size.height)/2,fill:"#cccccc",stroke:"#666666",strokeWidth:1,rotation:t.rotation,opacity:t.opacity,visible:t.visible,locked:t.locked};case"text":return{id:t.id,type:"text",x:t.position.x,y:t.position.y,text:"Text",fontSize:16,fontFamily:"Arial",fill:"#333333",rotation:t.rotation,opacity:t.opacity,visible:t.visible,locked:t.locked};case"image":return{id:t.id,type:"image",x:t.position.x,y:t.position.y,width:t.size.width,height:t.size.height,src:"",rotation:t.rotation,opacity:t.opacity,visible:t.visible,locked:t.locked};default:throw new Error(`Unsupported object type: ${t.type}`)}}getSuikaEditor(){return this.editor}static getPresetSizes(){return h}getToolAdapter(){return this.toolAdapter}activateTool(t){return this.toolAdapter?.activateTool(t)||!1}getActiveTool(){return this.toolAdapter?.getActiveTool()||null}getActiveToolType(){return this.toolAdapter?.getActiveToolType()||null}getAllToolConfigs(){return this.toolAdapter?.getAllToolConfigs()||[]}getToolConfig(t){return this.toolAdapter?.getToolConfig(t)}setToolProperties(t){this.toolAdapter?.setToolProperties(t)}getToolProperties(){return this.toolAdapter?.getToolProperties()||{}}handleMouseDown(t){this.toolAdapter?.handleMouseDown(t)}handleMouseMove(t){this.toolAdapter?.handleMouseMove(t)}handleMouseUp(t){this.toolAdapter?.handleMouseUp(t)}handleKeyDown(t){this.toolAdapter?.handleKeyDown(t)}handleKeyUp(t){this.toolAdapter?.handleKeyUp(t)}}},816:(t,e,i)=>{i.d(e,{b:()=>o});class o{constructor(){this.listeners=new Map}on(t,e){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e)}off(t,e){const i=this.listeners.get(t);i&&(i.delete(e),0===i.size&&this.listeners.delete(t))}emit(t,...e){const i=this.listeners.get(t);i&&i.forEach(i=>{try{i(...e)}catch(e){console.error(`Error in H5-Editor event listener for ${String(t)}:`,e)}})}removeAllListeners(t){t?this.listeners.delete(t):this.listeners.clear()}}},2410:(t,e,i)=>{i(1581);var o=i(4848),r=i(6540),s=i(816);class n{constructor(t){this.emitter=new s.b,this.currentPage=null,this.pages=new Map,this.options=t,this.containerElement=t.containerElement,this.canvasElement=document.createElement("canvas"),this.containerElement.appendChild(this.canvasElement),this.ctx=this.canvasElement.getContext("2d"),this.setupCanvas(),this.createDefaultPage()}setupCanvas(){const{width:t,height:e}=this.options,i=window.devicePixelRatio||1;this.canvasElement.width=t*i,this.canvasElement.height=e*i,this.canvasElement.style.width=`${t}px`,this.canvasElement.style.height=`${e}px`,this.ctx.scale(i,i)}createDefaultPage(){const t={id:"page_"+Date.now(),name:"页面1",width:this.options.width,height:this.options.height,background:{type:"color",value:"#ffffff"},components:[]};this.pages.set(t.id,t),this.setCurrentPage(t.id)}createPage(t){const e={id:"page_"+Date.now(),name:t,width:this.options.width,height:this.options.height,background:{type:"color",value:"#ffffff"},components:[]};return this.pages.set(e.id,e),e}setCurrentPage(t){const e=this.pages.get(t);e&&(this.currentPage=e,this.render(),this.emitter.emit("pageChange",e))}getCurrentPage(){return this.currentPage}getAllPages(){return Array.from(this.pages.values())}addComponent(t){this.currentPage&&(this.currentPage.components.push(t),this.render(),this.emitter.emit("componentAdd",t))}updateComponent(t,e){if(!this.currentPage)return;const i=this.currentPage.components.find(e=>e.id===t);i&&(Object.assign(i,e),this.render(),this.emitter.emit("componentUpdate",i))}removeComponent(t){if(!this.currentPage)return;const e=this.currentPage.components.findIndex(e=>e.id===t);-1!==e&&(this.currentPage.components.splice(e,1),this.render(),this.emitter.emit("componentRemove",t))}setPageBackground(t){this.currentPage&&(this.currentPage.background=t,this.render())}render(){if(!this.currentPage)return;const{width:t,height:e}=this.options;this.ctx.clearRect(0,0,t,e),this.renderBackground(),this.currentPage.components.forEach(t=>{this.renderComponent(t)})}renderBackground(){if(!this.currentPage)return;const{width:t,height:e}=this.options,{background:i}=this.currentPage;"color"===i.type&&(this.ctx.fillStyle=i.value,this.ctx.fillRect(0,0,t,e))}renderComponent(t){switch(this.ctx.save(),this.ctx.translate(t.x,t.y),t.type){case"text":this.renderTextComponent(t);break;case"image":this.renderImageComponent(t);break;case"button":this.renderButtonComponent(t);break;default:this.ctx.fillStyle="#cccccc",this.ctx.fillRect(0,0,t.width,t.height)}this.ctx.restore()}renderTextComponent(t){const{text:e,fontSize:i,color:o}=t.props;this.ctx.fillStyle=o||"#333333",this.ctx.font=`${i||16}px Arial`,this.ctx.textAlign="left",this.ctx.textBaseline="top",this.ctx.fillText(e||"Text",0,0)}renderImageComponent(t){this.ctx.fillStyle="#f0f0f0",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.strokeStyle="#ccc",this.ctx.strokeRect(0,0,t.width,t.height)}renderButtonComponent(t){const{text:e,backgroundColor:i,textColor:o}=t.props;this.ctx.fillStyle=i||"#007bff",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.fillStyle=o||"#ffffff",this.ctx.font="16px Arial",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(e||"Button",t.width/2,t.height/2)}exportAsImage(t="png",e=1){return this.canvasElement.toDataURL(`image/${t}`,e)}exportPageData(){return this.currentPage?{...this.currentPage}:null}on(t,e){this.emitter.on(t,e)}off(t,e){this.emitter.off(t,e)}destroy(){this.canvasElement&&this.containerElement.contains(this.canvasElement)&&this.containerElement.removeChild(this.canvasElement)}}(0,r.forwardRef)(({width:t,height:e,mode:i="mobile",onReady:s,onPageChange:h,onComponentAdd:a,onComponentUpdate:c,onComponentRemove:d,className:l,style:m},u)=>{const p=(0,r.useRef)(null),g=(0,r.useRef)(null);return(0,r.useImperativeHandle)(u,()=>({getEditor:()=>g.current,render:()=>g.current?.render(),destroy:()=>{g.current&&(g.current.destroy(),g.current=null)},exportAsImage:(t="png",e=1)=>g.current?.exportAsImage(t,e)||""})),(0,r.useEffect)(()=>{if(!p.current)return;const o={containerElement:p.current,width:t,height:e,mode:i},r=new n(o);return g.current=r,h&&r.on("pageChange",h),a&&r.on("componentAdd",a),c&&r.on("componentUpdate",c),d&&r.on("componentRemove",d),s&&s(r),()=>{g.current&&(g.current.destroy(),g.current=null)}},[t,e,i,s,h,a,c,d]),(0,o.jsx)("div",{ref:p,className:l,style:{width:`${t}px`,height:`${e}px`,position:"relative",overflow:"hidden",border:"1px solid #ddd",...m}})}).displayName="H5EditorCanvas"},3324:(t,e,i)=>{var o;i(614),function(t){t.MEMORY_WARNING="memory:warning",t.MEMORY_CRITICAL="memory:critical",t.GARBAGE_COLLECTED="memory:gc",t.OBJECT_POOLED="memory:pooled",t.CACHE_CLEARED="memory:cache-cleared",t.PERFORMANCE_UPDATE="performance:update"}(o||(o={}));var r=i(4848),s=i(6540),n=i(9620);(0,s.forwardRef)(({width:t,height:e,onReady:i,onSelectionChange:o,className:h,style:a},c)=>{const d=(0,s.useRef)(null),l=(0,s.useRef)(null);return(0,s.useImperativeHandle)(c,()=>({getEditor:()=>l.current,render:()=>l.current?.render(),destroy:()=>{l.current&&(l.current.destroy(),l.current=null)}})),(0,s.useEffect)(()=>{if(!d.current)return;const r={containerElement:d.current,width:t,height:e,showPerfMonitor:!1},s=new n.z(r);return l.current=s,o&&s.on("selectionChange",o),i&&i(s),()=>{l.current&&(l.current.destroy(),l.current=null)}},[t,e,i,o]),(0,s.useEffect)(()=>{l.current&&l.current.viewportManager.setViewport({x:-t/2,y:-e/2,width:t,height:e})},[t,e]),(0,r.jsx)("div",{ref:d,className:h,style:{width:`${t}px`,height:`${e}px`,position:"relative",overflow:"hidden",...a}})}).displayName="SuikaCanvas",i(6505)},6505:(t,e,i)=>{i.d(e,{t:()=>s});var o=i(9631);const r={[o.p.SELECT]:{type:o.p.SELECT,name:"选择",icon:"select",shortcut:"V",cursor:"default"},[o.p.TEXT]:{type:o.p.TEXT,name:"文本",icon:"text",shortcut:"T",cursor:"text"},[o.p.IMAGE]:{type:o.p.IMAGE,name:"图片",icon:"image",shortcut:"I",cursor:"crosshair"},[o.p.RECTANGLE]:{type:o.p.RECTANGLE,name:"矩形",icon:"rectangle",shortcut:"R",cursor:"crosshair"},[o.p.CIRCLE]:{type:o.p.CIRCLE,name:"圆形",icon:"circle",shortcut:"C",cursor:"crosshair"},[o.p.BRUSH]:{type:o.p.BRUSH,name:"画笔",icon:"brush",shortcut:"B",cursor:"crosshair"},[o.p.PAN]:{type:o.p.PAN,name:"平移",icon:"pan",shortcut:"H",cursor:"grab"},[o.p.LINE]:{type:o.p.LINE,name:"直线",icon:"line",shortcut:"L",cursor:"crosshair"},[o.p.POLYGON]:{type:o.p.POLYGON,name:"多边形",icon:"polygon",shortcut:"P",cursor:"crosshair"},[o.p.STAR]:{type:o.p.STAR,name:"星形",icon:"star",shortcut:"S",cursor:"crosshair"},[o.p.CROP]:{type:o.p.CROP,name:"裁剪",icon:"crop",shortcut:"O",cursor:"crosshair"},[o.p.ZOOM]:{type:o.p.ZOOM,name:"缩放",icon:"zoom",shortcut:"Z",cursor:"zoom-in"}};class s{constructor(t){this.activeTool=null,this.toolProperties={}}activateTool(t){const e=this.createToolWrapper(t);return e?(this.activeTool=e,!0):(console.warn(`Failed to create tool for type: ${t}`),!1)}deactivateTool(){this.activeTool=null}getActiveTool(){return this.activeTool}getActiveToolType(){return null}getAllToolConfigs(){return Object.values(r)}getToolConfig(t){return r[t]}setToolProperties(t){this.toolProperties={...this.toolProperties,...t},this.syncPropertiesToSuika(t)}getToolProperties(){return{...this.toolProperties}}handleMouseDown(t){}handleMouseMove(t){}handleMouseUp(t){}handleKeyDown(t){this.handleShortcut(t)}handleKeyUp(t){}render(t){}createToolWrapper(t){const e=r[t];return e?{type:t,config:e,state:{isActive:!0,isDragging:!1,properties:this.toolProperties},activate:()=>{this.activateTool(t)},deactivate:()=>{this.deactivateTool()},onMouseDown:this.handleMouseDown.bind(this),onMouseMove:this.handleMouseMove.bind(this),onMouseUp:this.handleMouseUp.bind(this),onKeyDown:this.handleKeyDown.bind(this),onKeyUp:this.handleKeyUp.bind(this),render:this.render.bind(this)}:(console.error(`No config found for tool type: ${t}`),null)}handleShortcut(t){const e=t.key.toLowerCase();for(const[i,o]of Object.entries(r))if(o.shortcut&&o.shortcut.toLowerCase()===e)return t.preventDefault(),void this.activateTool(i)}syncPropertiesToSuika(t){}destroy(){this.activeTool=null}}},9620:(t,e,i)=>{i.d(e,{z:()=>l});class o{constructor(){this.listeners=new Map}on(t,e){this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t).add(e)}off(t,e){const i=this.listeners.get(t);i&&(i.delete(e),0===i.size&&this.listeners.delete(t))}emit(t,...e){const i=this.listeners.get(t);i&&i.forEach(i=>{try{i(...e)}catch(e){console.error(`Error in event listener for ${String(t)}:`,e)}})}removeAllListeners(t){t?this.listeners.delete(t):this.listeners.clear()}}class r{constructor(t){this.isPanning=!1,this.panStart={x:0,y:0},this.lastPanTime=0,this.panVelocity={x:0,y:0},this.editor=t,this.viewport={x:0,y:0,width:0,height:0},this.options={minZoom:.5,maxZoom:2,zoomStep:.1,smoothZoom:!0,enablePan:!0,enableZoom:!0}}setViewport(t){this.viewport={...this.viewport,...t},this.clampViewport(),this.editor.render()}getViewport(){return{...this.viewport}}pan(t,e){this.options.enablePan&&(this.viewport.x+=t,this.viewport.y+=e,this.clampViewport(),this.editor.render())}smoothPan(t,e,i=300){if(!this.options.enablePan)return;const o=performance.now(),r=this.viewport.x,s=this.viewport.y,n=r+t,h=s+e,a=t=>{const e=t-o,c=Math.min(e/i,1),d=this.easeOutCubic(c);this.viewport.x=r+(n-r)*d,this.viewport.y=s+(h-s)*d,this.clampViewport(),this.editor.render(),c<1&&requestAnimationFrame(a)};requestAnimationFrame(a)}zoomAt(t,e,i){if(!this.options.enableZoom)return;const o=this.editor.zoomManager.getZoom(),r=Math.max(this.options.minZoom,Math.min(this.options.maxZoom,o*i));if(r!==o){const i=t,s=e,n=r/o;this.viewport.x=i-(i-this.viewport.x)*n,this.viewport.y=s-(s-this.viewport.y)*n,this.editor.zoomManager.setZoom(r),this.clampViewport(),this.editor.render()}}fitToScreen(){const t=this.editor.canvasElement,e=this.editor.containerElement,i=t.width,o=t.height,r=e.clientWidth,s=e.clientHeight,n=r/i,h=s/o,a=Math.min(n,h,this.options.maxZoom),c=(r-i*a)/2,d=(s-o*a)/2;this.viewport={x:c,y:d,width:r,height:s},this.editor.zoomManager.setZoom(a),this.editor.render()}fitToContent(){const t=this.editor.sceneGraph.getAllBounds();if(!t)return;const e=this.editor.containerElement,i=e.clientWidth,o=e.clientHeight,r=t.width+100,s=t.height+100,n=i/r,h=o/s,a=Math.min(n,h,this.options.maxZoom),c=s*a,d=(i-r*a)/2-t.x*a,l=(o-c)/2-t.y*a;this.viewport={x:d,y:l,width:i,height:o},this.editor.zoomManager.setZoom(a),this.editor.render()}resetViewport(){this.viewport={x:0,y:0,width:0,height:0},this.editor.zoomManager.setZoom(1),this.editor.render()}startPan(t,e){this.options.enablePan&&(this.isPanning=!0,this.panStart={x:t,y:e},this.panVelocity={x:0,y:0},this.lastPanTime=performance.now())}updatePan(t,e){if(!this.isPanning||!this.options.enablePan)return;const i=t-this.panStart.x,o=e-this.panStart.y;this.pan(-i,-o);const r=performance.now(),s=r-this.lastPanTime;s>0&&(this.panVelocity.x=-i/s,this.panVelocity.y=-o/s),this.panStart={x:t,y:e},this.lastPanTime=r}endPan(){this.isPanning&&(this.isPanning=!1,(Math.abs(this.panVelocity.x)>.1||Math.abs(this.panVelocity.y)>.1)&&this.applyInertia())}applyInertia(){const t=()=>{Math.abs(this.panVelocity.x)<.1&&Math.abs(this.panVelocity.y)<.1||(this.pan(this.panVelocity.x,this.panVelocity.y),this.panVelocity.x*=.95,this.panVelocity.y*=.95,requestAnimationFrame(t))};requestAnimationFrame(t)}clampViewport(){const t=this.getContentBounds();t&&(Math.abs(this.viewport.x-t.centerX)>5e4||Math.abs(this.viewport.y-t.centerY)>5e4)&&console.warn("视口距离内容过远，可能影响性能")}getContentBounds(){const t=this.editor.sceneGraph.getObjects();if(0===t.length)return null;let e=1/0,i=1/0,o=-1/0,r=-1/0;return t.forEach(t=>{if(void 0!==t.x&&void 0!==t.y){const s=t.x,n=t.y,h=t.x+(t.width||0),a=t.y+(t.height||0);e=Math.min(e,s),i=Math.min(i,n),o=Math.max(o,h),r=Math.max(r,a)}}),e===1/0?null:{centerX:(e+o)/2,centerY:(i+r)/2,width:o-e,height:r-i}}easeOutCubic(t){return 1-Math.pow(1-t,3)}getOptions(){return{...this.options}}setOptions(t){this.options={...this.options,...t}}getViewportState(){return{viewport:this.getViewport(),isPanning:this.isPanning}}}class s{constructor(t){this.currentZoom=1,this.targetZoom=1,this.isAnimating=!1,this.animationStartTime=0,this.animationDuration=300,this.editor=t,this.options={minZoom:.1,maxZoom:5,zoomStep:.1,smoothZoom:!0,zoomDuration:300}}setZoom(t){const e=this.clampZoom(t);this.options.smoothZoom&&Math.abs(e-this.currentZoom)>.01?this.animateZoom(e):(this.currentZoom=e,this.editor.render())}getZoom(){return this.currentZoom}zoomAt(t,e,i){const o=this.clampZoom(this.currentZoom*i);if(o!==this.currentZoom){const i=t,r=e,s=o/this.currentZoom,n=this.editor.viewportManager.getViewport(),h=i-(i-n.x)*s,a=r-(r-n.y)*s;this.editor.viewportManager.setViewport({x:h,y:a}),this.setZoom(o)}}zoomToFit(){const t=this.editor.canvasElement,e=this.editor.containerElement,i=t.width,o=t.height,r=e.clientWidth/i,s=e.clientHeight/o,n=Math.min(r,s,this.options.maxZoom);this.setZoom(n)}zoomToContent(){const t=this.editor.sceneGraph.getAllBounds();if(!t)return;const e=this.editor.containerElement,i=e.clientWidth,o=e.clientHeight,r=i/(t.width+100),s=o/(t.height+100),n=Math.min(r,s,this.options.maxZoom);this.setZoom(n)}zoomIn(t=this.options.zoomStep){this.setZoom(this.currentZoom+t)}zoomOut(t=this.options.zoomStep){this.setZoom(this.currentZoom-t)}resetZoom(){this.setZoom(1)}getZoomTransform(){return{scaleX:this.currentZoom,scaleY:this.currentZoom}}viewportToScene(t,e){const i=this.editor.viewportManager.getViewport();return{x:(t-i.x)/this.currentZoom,y:(e-i.y)/this.currentZoom}}sceneToViewport(t,e){const i=this.editor.viewportManager.getViewport();return{x:t*this.currentZoom+i.x,y:e*this.currentZoom+i.y}}viewportToSceneSize(t){return t/this.currentZoom}sceneToViewportSize(t){return t*this.currentZoom}animateZoom(t){if(this.isAnimating)return void(this.targetZoom=t);this.isAnimating=!0,this.targetZoom=t,this.animationStartTime=performance.now();const e=t=>{const i=t-this.animationStartTime,o=Math.min(i/this.animationDuration,1),r=this.easeOutCubic(o);this.currentZoom=this.currentZoom+(this.targetZoom-this.currentZoom)*r,this.editor.render(),o<1?requestAnimationFrame(e):(this.isAnimating=!1,this.currentZoom=this.targetZoom)};requestAnimationFrame(e)}clampZoom(t){return Math.max(this.options.minZoom,Math.min(this.options.maxZoom,t))}easeOutCubic(t){return 1-Math.pow(1-t,3)}getOptions(){return{...this.options}}setOptions(t){this.options={...this.options,...t}}getZoomState(){return{currentZoom:this.currentZoom,targetZoom:this.targetZoom,isAnimating:this.isAnimating}}isZoomInRange(t){return t>=this.options.minZoom&&t<=this.options.maxZoom}getZoomPercentage(){return Math.round(100*this.currentZoom)}setZoomPercentage(t){this.setZoom(t/100)}}class n{constructor(){this.objects=new Map}insert(t,e){this.objects.set(t,e)}remove(t){this.objects.delete(t)}query(t){const e=[];for(const[i,o]of this.objects.entries())this.intersects(t,o)&&e.push(i);return e}update(t,e){this.objects.set(t,e)}clear(){this.objects.clear()}intersects(t,e){return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)}}class h{constructor(t){this.objects=new Map,this.renderOrder=[],this.spatialIndex=new n,this.editor=t}addObject(t){if(this.objects.has(t.id))throw new Error(`Object with id ${t.id} already exists`);this.objects.set(t.id,t),this.renderOrder.push(t.id);const e=this.calculateObjectBounds(t);e&&this.spatialIndex.insert(t.id,e)}removeObject(t){if(!this.objects.has(t))throw new Error(`Object with id ${t} not found`);this.objects.delete(t);const e=this.renderOrder.indexOf(t);e>-1&&this.renderOrder.splice(e,1),this.spatialIndex.remove(t)}getObject(t){return this.objects.get(t)}getObjects(){return this.renderOrder.map(t=>this.objects.get(t))}updateObject(t,e){const i=this.objects.get(t);if(!i)throw new Error(`Object with id ${t} not found`);Object.assign(i,e);const o=this.calculateObjectBounds(i);o&&this.spatialIndex.update(t,o)}render(t){const e=this.editor.viewportManager.getViewport(),i=this.editor.zoomManager.getZoom(),o={x:-e.x/i,y:-e.y/i,width:e.width/i,height:e.height/i},r=this.spatialIndex.query(o);for(const e of this.renderOrder){if(!e||!r.includes(e))continue;const i=this.objects.get(e);i&&!1!==i.visible&&this.renderObject(t,i)}}renderObject(t,e){switch(t.save(),e.type){case"rect":this.renderRect(t,e);break;case"circle":this.renderCircle(t,e);break;case"text":this.renderText(t,e);break;case"image":this.renderImage(t,e);break;default:console.warn(`Unknown object type: ${e.type}`)}t.restore()}renderRect(t,e){e.fill&&(t.fillStyle=e.fill,t.fillRect(e.x,e.y,e.width||0,e.height||0)),e.stroke&&e.strokeWidth&&(t.strokeStyle=e.stroke,t.lineWidth=e.strokeWidth,t.strokeRect(e.x,e.y,e.width||0,e.height||0))}renderCircle(t,e){const i=e.radius||0;t.beginPath(),t.arc(e.x,e.y,i,0,2*Math.PI),e.fill&&(t.fillStyle=e.fill,t.fill()),e.stroke&&e.strokeWidth&&(t.strokeStyle=e.stroke,t.lineWidth=e.strokeWidth,t.stroke())}renderText(t,e){e.text&&(t.font=`${e.fontSize||16}px ${e.fontFamily||"Arial"}`,e.fill&&(t.fillStyle=e.fill,t.fillText(e.text,e.x,e.y)),e.stroke&&e.strokeWidth&&(t.strokeStyle=e.stroke,t.lineWidth=e.strokeWidth,t.strokeText(e.text,e.x,e.y)))}renderImage(t,e){if(!e.src)return;const i=new Image;i.onload=()=>{t.drawImage(i,e.x,e.y,e.width||i.width,e.height||i.height)},i.src=e.src}getObjectBounds(t){const e=this.objects.get(t);if(!e)return null;switch(e.type){case"rect":case"image":return{x:e.x,y:e.y,width:e.width||0,height:e.height||0};case"circle":const t=e.radius||0;return{x:e.x-t,y:e.y-t,width:2*t,height:2*t};case"text":const i=document.createElement("canvas").getContext("2d"),o=e.fontSize||16,r=e.fontFamily||"Arial";i.font=`${o}px ${r}`;const s=e.text||"",n=i.measureText(s);return{x:e.x,y:e.y-(e.fontSize||16),width:n.width,height:e.fontSize||16};default:return null}}getAllBounds(){if(0===this.objects.size)return null;let t=1/0,e=1/0,i=-1/0,o=-1/0;for(const r of this.renderOrder){const s=this.getObjectBounds(r);s&&(t=Math.min(t,s.x),e=Math.min(e,s.y),i=Math.max(i,s.x+s.width),o=Math.max(o,s.y+s.height))}return t===1/0?null:{x:t,y:e,width:i-t,height:o-e}}findObjectAtPoint(t,e){for(let i=this.renderOrder.length-1;i>=0;i--){const o=this.renderOrder[i];if(!o)continue;const r=this.objects.get(o);if(r&&!1!==r.visible){const i=this.getObjectBounds(r.id);if(i&&this.pointInBounds(t,e,i))return r}}return null}pointInBounds(t,e,i){return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height}clear(){this.objects.clear(),this.renderOrder=[],this.spatialIndex.clear()}calculateObjectBounds(t){switch(t.type){case"rect":case"image":return{x:t.x,y:t.y,width:t.width||0,height:t.height||0};case"circle":const e=t.radius||0;return{x:t.x-e,y:t.y-e,width:2*e,height:2*e};case"text":const i=t.fontSize||16,o=(t.text||"").length*i*.6;return{x:t.x,y:t.y-i,width:o,height:i};default:return null}}getVisibleObjects(t){return this.spatialIndex.query(t).map(t=>this.objects.get(t)).filter(Boolean)}getSpatialIndexStats(){return{totalObjects:this.objects.size,indexedObjects:this.objects.size}}getStats(){let t=0,e=0;for(const i of this.objects.values())!1!==i.visible&&t++,!0===i.locked&&e++;return{objectCount:this.objects.size,visibleCount:t,lockedCount:e}}}class a{constructor(t){this.name="select",this.type="select",this.isActive=!1,this.selectedObjects=[],this.isDragging=!1,this.dragStart={x:0,y:0},this.dragOffset={x:0,y:0},this.editor=t}activate(){this.isActive=!0}deactivate(){this.isActive=!1,this.clearSelection()}handleMouseDown(t,e,i){if(!this.isActive)return;const o=this.editor.sceneGraph.findObjectAtPoint(t,e);o?(i.ctrlKey||i.metaKey||this.clearSelection(),this.selectObject(o.id),this.isDragging=!0,this.dragStart={x:t,y:e},this.dragOffset={x:0,y:0}):i.ctrlKey||i.metaKey||this.clearSelection()}handleMouseMove(t,e,i){this.isActive&&this.isDragging&&(this.dragOffset={x:t-this.dragStart.x,y:e-this.dragStart.y},this.moveSelectedObjects(this.dragOffset.x,this.dragOffset.y),this.dragStart={x:t,y:e})}handleMouseUp(t,e,i){this.isActive&&(this.isDragging=!1)}render(t){this.isActive&&this.renderSelectionBoxes(t)}selectObject(t){this.selectedObjects.includes(t)||this.selectedObjects.push(t)}deselectObject(t){const e=this.selectedObjects.indexOf(t);e>-1&&this.selectedObjects.splice(e,1)}clearSelection(){this.selectedObjects=[]}getSelectedObjects(){return[...this.selectedObjects]}moveSelectedObjects(t,e){const i=this.editor.sceneGraph;for(const o of this.selectedObjects){const r=i.getObject(o);r&&i.updateObject(o,{x:r.x+t,y:r.y+e})}}renderSelectionBoxes(t){const e=this.editor.sceneGraph;t.save(),t.strokeStyle="#0066ff",t.lineWidth=2,t.setLineDash([5,5]);for(const i of this.selectedObjects){const o=e.getObjectBounds(i);o&&t.strokeRect(o.x,o.y,o.width,o.height)}t.restore()}}class c{constructor(t){this.tools=new Map,this.activeTool=null,this.editor=t,this.initializeTools()}initializeTools(){const t=new a(this.editor);this.tools.set("select",t),this.setActiveTool("select")}setActiveTool(t){const e=this.tools.get(t);e?(this.activeTool&&this.activeTool.deactivate(),this.activeTool=e,this.activeTool.activate()):console.warn(`Tool ${t} not found`)}getActiveTool(){return this.activeTool}getTools(){return Array.from(this.tools.values())}handleMouseDown(t,e,i){this.activeTool&&this.activeTool.handleMouseDown(t,e,i)}handleMouseMove(t,e,i){this.activeTool&&this.activeTool.handleMouseMove(t,e,i)}handleMouseUp(t,e,i){this.activeTool&&this.activeTool.handleMouseUp(t,e,i)}render(t){this.activeTool&&this.activeTool.render(t)}selectObjects(t){const e=this.tools.get("select");e&&(e.clearSelection(),t.forEach(t=>e.selectObject(t)))}clearSelection(){const t=this.tools.get("select");t&&t.clearSelection()}getSelectedObjects(){const t=this.tools.get("select");return t?t.getSelectedObjects():[]}handleKeyDown(t){this.activeTool&&"function"==typeof this.activeTool.handleKeyDown&&this.activeTool.handleKeyDown(t)}handleKeyUp(t){this.activeTool&&"function"==typeof this.activeTool.handleKeyUp&&this.activeTool.handleKeyUp(t)}addTool(t){this.tools.set(t.name,t)}removeTool(t){this.activeTool&&this.activeTool.name===t&&(this.activeTool.deactivate(),this.activeTool=null),this.tools.delete(t)}}class d{constructor(t){this.history=[],this.currentIndex=-1,this.maxHistorySize=100,this.editor=t}execute(t){t.execute(),this.history=this.history.slice(0,this.currentIndex+1);const e=this.history[this.currentIndex];if(e&&e.canMerge&&e.canMerge(t)){const i=e.merge&&e.merge(t);i&&(this.history[this.currentIndex]=i)}else this.history.push(t),this.currentIndex++,this.history.length>this.maxHistorySize&&(this.history.shift(),this.currentIndex--);this.editor.render()}undo(){if(!this.canUndo())return!1;const t=this.history[this.currentIndex];return!!t&&(t.undo(),this.currentIndex--,this.editor.render(),!0)}redo(){if(!this.canRedo())return!1;this.currentIndex++;const t=this.history[this.currentIndex];return!!t&&(t.execute(),this.editor.render(),!0)}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.history.length-1}clear(){this.history=[],this.currentIndex=-1}getHistorySize(){return this.history.length}getCurrentIndex(){return this.currentIndex}}class l{constructor(t){for(this.emitter=new o,this.perfMonitor=null,this.lastRenderTime=0,this.boundHandlers=null,this.resizeObserver=null,this.options=t,this.containerElement=t.containerElement,this.paperId="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)});this.containerElement.firstChild;)this.containerElement.removeChild(this.containerElement.firstChild);this.canvasElement=document.createElement("canvas"),this.canvasElement.style.width="100%",this.canvasElement.style.height="100%",this.canvasElement.setAttribute("data-suika-canvas","true");try{this.containerElement.appendChild(this.canvasElement)}catch(t){throw console.error("Failed to append canvas to container:",t),t}const e=this.canvasElement.getContext("2d");if(!e)throw new Error("Failed to get 2D rendering context");this.ctx=e,this.resizeCanvas(),this.viewportManager=new r(this),this.zoomManager=new s(this),this.sceneGraph=new h(this),this.toolManager=new c(this),this.commandManager=new d(this),this.viewportManager.setViewport({x:-t.width/2,y:-t.height/2,width:t.width,height:t.height}),t.showPerfMonitor&&this.initPerfMonitor(),this.bindEvents(),Promise.resolve().then(()=>{this.render()})}resizeCanvas(){const t=this.containerElement.getBoundingClientRect();this.canvasElement.width=t.width,this.canvasElement.height=t.height}initPerfMonitor(){this.perfMonitor={startTime:0,frameCount:0,fps:0}}bindEvents(){this.boundHandlers={mouseDown:this.handleMouseDown.bind(this),mouseMove:this.handleMouseMove.bind(this),mouseUp:this.handleMouseUp.bind(this),wheel:this.handleWheel.bind(this)},this.resizeObserver=new ResizeObserver(()=>{this.resizeCanvas(),this.render()}),this.resizeObserver.observe(this.containerElement),this.canvasElement.addEventListener("mousedown",this.boundHandlers.mouseDown),this.canvasElement.addEventListener("mousemove",this.boundHandlers.mouseMove),this.canvasElement.addEventListener("mouseup",this.boundHandlers.mouseUp),this.canvasElement.addEventListener("wheel",this.boundHandlers.wheel)}handleMouseDown(t){const{x:e,y:i}=this.getSceneCursorXY(t);this.toolManager.handleMouseDown(e,i,t)}handleMouseMove(t){const{x:e,y:i}=this.getSceneCursorXY(t);this.toolManager.handleMouseMove(e,i,t)}handleMouseUp(t){const{x:e,y:i}=this.getSceneCursorXY(t);this.toolManager.handleMouseUp(e,i,t)}handleWheel(t){t.preventDefault();const{x:e,y:i}=this.getSceneCursorXY(t),o=t.deltaY>0?.9:1.1;this.zoomManager.zoomAt(e,i,o)}toScenePt(t,e){const i=this.zoomManager.getZoom(),o=this.viewportManager.getViewport();return{x:(t-o.x)/i,y:(e-o.y)/i}}toViewportPt(t,e){const i=this.zoomManager.getZoom(),o=this.viewportManager.getViewport();return{x:t*i+o.x,y:e*i+o.y}}getCursorXY(t){const e=this.canvasElement.getBoundingClientRect();return{x:t.clientX-e.left-(this.options.offsetX||0),y:t.clientY-e.top-(this.options.offsetY||0)}}getSceneCursorXY(t){const{x:e,y:i}=this.getCursorXY(t);return this.toScenePt(e,i)}render(){this.ctx.clearRect(0,0,this.canvasElement.width,this.canvasElement.height);const t=this.zoomManager.getZoom(),e=this.viewportManager.getViewport();if(this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.scale(t,t),this.sceneGraph.render(this.ctx),this.ctx.restore(),this.toolManager.render(this.ctx),this.perfMonitor){const t=performance.now();this.perfMonitor.frameCount++,this.perfMonitor.fps=1e3/(t-this.lastRenderTime),this.lastRenderTime=t}this.emitter.emit("render")}getPerformanceInfo(){return{fps:this.perfMonitor?.fps||0,frameCount:this.perfMonitor?.frameCount||0}}destroy(){try{if(this.unbindEvents(),this.viewportManager&&(this.viewportManager=void 0),this.zoomManager&&(this.zoomManager=void 0),this.sceneGraph&&(this.sceneGraph=void 0),this.toolManager&&(this.toolManager=void 0),this.commandManager&&(this.commandManager=void 0),this.canvasElement)try{const t=this.canvasElement.parentNode||this.canvasElement.parentElement;t&&Array.from(t.childNodes).includes(this.canvasElement)&&t.removeChild(this.canvasElement)}catch(t){try{"function"==typeof this.canvasElement.remove&&this.canvasElement.remove()}catch(t){if(console.warn("Failed to remove canvas element:",t),this.containerElement&&this.containerElement.contains(this.canvasElement))try{this.containerElement.innerHTML=""}catch(t){console.warn("Failed to clear container innerHTML:",t)}}}if(this.containerElement)try{for(;this.containerElement.firstChild;){const t=this.containerElement.firstChild;if(t.parentNode!==this.containerElement)break;this.containerElement.removeChild(t)}}catch(t){console.warn("Failed to clear container children:",t);try{this.containerElement.innerHTML=""}catch(t){console.warn("Failed to clear container innerHTML:",t)}}this.canvasElement=null,this.ctx=null,this.containerElement=null,console.log("SuikaEditor destroyed successfully")}catch(t){console.error("Error during SuikaEditor destruction:",t)}}unbindEvents(){try{this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.canvasElement&&this.boundHandlers&&(this.canvasElement.removeEventListener("mousedown",this.boundHandlers.mouseDown),this.canvasElement.removeEventListener("mousemove",this.boundHandlers.mouseMove),this.canvasElement.removeEventListener("mouseup",this.boundHandlers.mouseUp),this.canvasElement.removeEventListener("wheel",this.boundHandlers.wheel)),this.boundHandlers=null}catch(t){console.warn("Error unbinding events:",t)}}on(t,e){this.emitter.on(t,e)}off(t,e){this.emitter.off(t,e)}getState(){return{zoom:this.zoomManager.getZoom(),viewport:this.viewportManager.getViewport(),selectedObjects:this.toolManager.getSelectedObjects(),sceneObjects:this.sceneGraph.getObjects()}}setState(t){void 0!==t.zoom&&this.zoomManager.setZoom(t.zoom),void 0!==t.viewport&&this.viewportManager.setViewport(t.viewport),this.render()}}}}]);
//# sourceMappingURL=engines.c0fb6648859cdc480768.js.map